<head>
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/modules/admin.css">
</head>

<div class="admin-layout">
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <span>ğŸ› ï¸</span>
                <h1>AIç®¡ç†åŠ©æ‰‹</h1>
            </div>
            <!-- æ·»åŠ ç™»å‡ºæŒ‰é’® -->
            <button id="logout-btn" class="logout-btn">
                <span class="icon">ğŸšª</span>
                <span class="text">é€€å‡ºç™»å½•</span>
            </button>
        </div>
        <ul class="menu-list">
            <!-- å·¥ä½œå°èœå•é¡¹æ·»åŠ ç¦ç”¨æ ·å¼ -->
            <li class="menu-item disabled">
                <span class="icon">ğŸ </span>
                <span class="text">å·¥ä½œå°</span>
            </li>
            
            <!-- å­èœå•é¡¹ä¿æŒåŸæœ‰ç»“æ„ -->
            <ul class="submenu">
                <!-- æ¯ä¸ªèœå•é¡¹å¿…é¡»åŒ…å«data-typeå±æ€§ -->
                <li class="menu-item" data-type="users">
                    <span class="icon">ğŸ‘¥</span>
                    <span class="text">ç”¨æˆ·ç®¡ç†</span>
                </li>
                <li class="menu-item" data-type="knowledge">
                    <span class="icon">ğŸ“š</span>
                    <span class="text">çŸ¥è¯†åº“</span>
                </li>
                <li class="menu-item" data-type="settings">
                    <span class="icon">âš™ï¸</span>
                    <span class="text">ç³»ç»Ÿè®¾ç½®</span>
                </li>
            </ul>
            
            <script>
            document.addEventListener('DOMContentLoaded', () => {
                // ä»…ç»‘å®šå­èœå•ç‚¹å‡»äº‹ä»¶
                document.querySelectorAll('.submenu .menu-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const type = this.dataset.type;
                        // æ¸…é™¤æ‰€æœ‰æ¿€æ´»çŠ¶æ€
                        document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
                        // è®¾ç½®å½“å‰æ¿€æ´»é¡¹
                        this.classList.add('active');
                        loadContent(type);
                    });
                });
            });
            </script>
        </ul>
    </div>
    <div class="content-container">
        <div id="dynamic-content">
            <!-- é»˜è®¤æ˜¾ç¤ºå·¥ä½œå°å†…å®¹ -->
            <div class="welcome-panel">
                <h3>æ¬¢è¿ä½¿ç”¨AIç®¡ç†åŠ©æ‰‹</h3>
                <p>è¯·ä»å·¦ä¾§èœå•é€‰æ‹©åŠŸèƒ½æ¨¡å—</p>
            </div>
        </div>
    </div>
</div>


<script>
    // ä¿®æ”¹å‰
    function logout() {
        fetch('/logout', { method: 'GET' })
    }
    
    // ä¿®æ”¹å
    function logout() {
        fetch('/logout', { 
            method: 'POST',
            credentials: 'include'  // ç¡®ä¿æºå¸¦cookie
        }).then(() => window.location.href = '/login')
    }
    </script>


<script>
document.addEventListener('DOMContentLoaded', () => {
    // ç»Ÿä¸€äº‹ä»¶ç»‘å®šï¼ˆåˆ é™¤é‡å¤çš„ç»‘å®šä»£ç ï¼‰
    document.querySelector('.submenu').addEventListener('click', (e) => {
        const menuItem = e.target.closest('.menu-item');
        if (menuItem && menuItem.dataset.type) {
            // æ¸…é™¤æ‰€æœ‰æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
            // è®¾ç½®å½“å‰æ¿€æ´»é¡¹
            menuItem.classList.add('active');
            // æ›´æ–°æ ‡é¢˜
            document.getElementById('current-module').textContent = menuItem.querySelector('.text').textContent;
            loadContent(menuItem.dataset.type);
        }
    });
});

// ä¿®å¤å‡½æ•°é—­åˆé—®é¢˜
async function loadContent(type) {
    try {
        const response = await fetch(`/admin/get-content?type=${encodeURIComponent(type)}`);
        if (!response.ok) throw new Error('åŠ è½½å¤±è´¥');
        document.getElementById('dynamic-content').innerHTML = await response.text();
    } catch (error) {
        console.error('åŠ è½½å¤±è´¥:', error);
    }
} // æ·»åŠ ç¼ºå¤±çš„é—­åˆæ‹¬å·
</script>

<script>
// ä¿®æ”¹å‰
function logout() {
    fetch('/logout', { method: 'GET' })
}

// ä¿®æ”¹å
function logout() {
    fetch('/logout', { 
        method: 'POST',
        credentials: 'include'  // ç¡®ä¿æºå¸¦cookie
    }).then(() => window.location.href = '/login')
}
</script>